<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <title>VARZIN â€“ Field Index | Phase-Sync Interface (v5.8)</title>
  <meta name="description" content="VARZIN Field Index â€“ Phase-Sync Interface with Real-Time Spectrogram, Harmonic Blend AI, and Luxvar Code Injection capabilities." />
  <meta name="author" content="Reza Nirouyar (RAHTALÄ’Nâ€“13)" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Vazirmatn:wght@400;500;700&display=swap" rel="stylesheet" />
  <link rel="icon" href="https://varzin.org/assets/favicon.png" type="image/png" />
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
  <style>
    :root {
      --bg:#000; --text:#cceeee; --muted:#a7e7e7;
      --cyan:#00ffee; --gold:#ffcc00;
      --panel:rgba(0,10,15,0.95); --border:rgba(0,255,238,0.3);
      --font:'DM Sans','Vazirmatn',sans-serif;
    }
    body {
      margin:0; font-family:var(--font); background:var(--bg); color:var(--text);
      line-height:1.7; overflow-x:hidden; padding:40px 16px 80px;
    }
    #field-canvas { position:fixed; top:0; left:0; width:100%; height:100%; z-index:-1; opacity:0.6; }
    header h1 { text-align:center; color:var(--cyan); font-size:2.8em; text-shadow:0 0 25px var(--cyan); }
    header p { text-align:center; color:var(--muted); margin-bottom:40px; font-style:italic; }
    nav { text-align:center; margin-bottom:30px; border-bottom:2px solid var(--border); padding-bottom:15px; }
    nav a { color:var(--text); text-decoration:none; margin:0 15px; font-weight:500; }
    nav a:hover { color:var(--cyan); text-shadow:0 0 10px var(--cyan); }

    /* Global Control Bar and Input Interface */
    #control-bar, #luxvar-input-interface {
        max-width: 1200px; margin: 0px auto 30px; 
        padding: 15px 0; border-top: 1px dashed var(--border);
    }
    #control-bar {
        display: flex; justify-content: center; flex-wrap: wrap; gap: 10px;
        margin-bottom: 40px;
    }
    .control-btn {
        background: rgba(0, 255, 238, 0.1); color: var(--cyan); border: 1px solid var(--cyan);
        padding: 8px 15px; border-radius: 8px; cursor: pointer; font-weight: 500;
        transition: background 0.3s, transform 0.1s, box-shadow 0.3s; font-size: 0.9em;
        white-space: nowrap;
    }
    .control-btn:hover { background: rgba(0, 255, 238, 0.2); box-shadow: 0 0 15px rgba(0, 255, 238, 0.5); }
    .control-btn:active { transform: scale(0.98); }
    .control-btn.active { 
        background: var(--cyan); color: var(--bg); border-color: var(--cyan);
        box-shadow: 0 0 20px var(--cyan);
    }
    .gold-btn {
        color: var(--gold); border-color: var(--gold);
        background: rgba(255, 204, 0, 0.1);
    }
    .gold-btn:hover {
        background: rgba(255, 204, 0, 0.2); 
        box-shadow: 0 0 15px rgba(255, 204, 0, 0.5);
    }

    main { max-width:1200px; margin:auto; display:grid; 
        grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:30px; 
    }
    .field-card { 
      background:var(--panel); border:1px solid var(--border); border-radius:12px;
      padding:25px; 
      box-shadow:0 0 15px rgba(0,255,238,0.1); transition:.4s ease; 
      display: flex; flex-direction: column; 
    }
    .field-card:hover { transform:translateY(-6px); box-shadow:0 0 25px rgba(0,255,238,0.5); }
    .field-card h3 { 
        color:var(--cyan); text-shadow:0 0 10px var(--cyan); border-bottom:1px dashed var(--border); 
        padding-bottom:10px; text-align:left; margin-bottom: 15px;
    }
    .key-attr { display:flex; justify-content:space-between; padding:4px 0; border-bottom:1px dotted rgba(0,255,238,0.1); font-size:0.95em; }
    .key-attr strong { color:var(--gold); min-width:120px; } 
    .description { font-size:0.95em; color:var(--muted); margin-top:15px; margin-bottom: 20px; text-align:justify; flex-grow: 1; }
    
    .chart-container { 
        margin-top:auto; 
        text-align:center; padding-top:10px; 
    }
    .chart-container canvas { 
        display: block; margin: 0 auto; 
        border:1px solid rgba(0,255,238,0.3); border-radius:10px;
    }
    .chart-container p { font-size:0.8em; color:var(--muted); margin-top:5px; margin-bottom:0; }
    .chart-container button { margin-top: 10px; }

    /* Kaltur specific layout for two side-by-side charts (Polar + Spectrogram) */
    #kaltur-section { grid-column:1 / -1; }
    #kaltur-section .kaltur-visuals {
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
    }
    #kaltur-section .kaltur-visuals .chart-container {
        flex: 1 1 280px; /* Allow them to stack on small screens */
        min-width: 280px;
    }

    /* --- ETFM POST Section --- */
    #etfm-post { grid-column:1 / -1; text-align:center; border:2px solid var(--cyan);
      box-shadow:0 0 30px rgba(0,255,238,0.4); margin-top:30px; padding:30px; } 
    #etfm-post h3 { font-size:2.4em; color:var(--cyan); text-shadow:0 0 20px var(--cyan); text-align:center; }
    #etfm-post p { color:var(--muted); }
    .formula-box {
      background:rgba(0,15,25,0.9); border:1px solid rgba(0,255,238,0.4);
      width:fit-content; margin:25px auto; padding:20px; border-radius:10px;
      color:var(--gold); line-height:1.6; text-align:left; 
      font-size: 1.1em;
    }
    .etfm-charts { 
        display: flex; justify-content: space-around; flex-wrap: wrap; gap: 20px;
        margin-top: 30px; 
        margin-bottom: 20px;
    }
    .etfm-charts .chart-container { flex: 1 1 45%; min-width: 250px; }

    footer { text-align:center; margin-top:80px; border-top:1px solid var(--border); padding-top:20px; color:var(--muted); }
    
    @media (max-width: 768px) {
        main { grid-template-columns: 1fr; }
        .key-attr { flex-direction: column; align-items: flex-start; }
        .key-attr strong { min-width: 100%; margin-bottom: 3px; }
        .etfm-charts { flex-direction: column; }
        #kaltur-section .kaltur-visuals { flex-direction: column; }
    }
    
    /* Custom Modal Styling for WebSerial Mockup */
    #connection-modal { 
        position:fixed; top:0; left:0; width:100%; height:100%; 
        background:rgba(0,0,0,0.8); z-index:1000; display:none; 
        justify-content:center; align-items:center;
    }
    #connection-modal > div {
        background:var(--panel); border:2px solid var(--gold); border-radius:12px; 
        padding:30px; max-width:450px; text-align:center; 
        box-shadow:0 0 25px rgba(255, 204, 0, 0.4);
    }
    #connection-progress {
        width:100%; height:8px; background:rgba(255, 204, 0, 0.2); 
        border-radius:4px; margin-bottom:20px;
    }
    #progress-filler {
        width:0%; height:100%; background:var(--gold); 
        border-radius:4px; transition:width 0.5s ease-out;
    }
  </style>
</head>
<body>
  <!-- Custom Modal for WebSerial Mockup (Enhanced in v5.8) -->
  <div id="connection-modal">
    <div>
        <h4 style="color:var(--gold); margin-top:0;">ðŸ”— Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø§ØªØµØ§Ù„ Ø¯Ø³ØªÚ¯Ø§Ù‡ VARZIN</h4>
        <p id="connection-status" style="color:var(--muted); margin-bottom:20px;">Ø¯Ø± Ø­Ø§Ù„ ØªÙ„Ø§Ø´ Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ù‚Ø±Ø§Ø±ÛŒ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù¾ÙˆØ±Øª WebSerial/Bluetooth...</p>
        <div id="connection-progress">
             <div id="progress-filler"></div>
        </div>
        <div id="live-data-display">
            <!-- Live data stream will appear here in v5.8 -->
        </div>
        <button class="control-btn gold-btn" id="close-modal-btn">Ø¨Ø³ØªÙ†</button>
    </div>
  </div>
